2025-08-08 16:53:23,075 - attribution-agent - INFO - ChatDeepSeek³õÊ¼»¯³É¹¦
2025-08-08 16:53:23,084 - attribution-agent - INFO - FastMCP´úÀíÁ¬½Ó³É¹¦: http://127.0.0.1:8010/mcp/
2025-08-08 16:53:23,102 - attribution-agent - INFO - ¹¥»÷ËİÔ´ÖÇÄÜÌå´´½¨³É¹¦
C:\Users\LEGION\Desktop\sec_agent\.venv\Lib\site-packages\websockets\legacy\__init__.py:6: DeprecationWarning: websockets.legacy is deprecated; see https://websockets.readthedocs.io/en/stable/howto/upgrade.html for upgrade instructions
  warnings.warn(  # deprecated in 14.0 - 2024-11-09
C:\Users\LEGION\Desktop\sec_agent\.venv\Lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py:14: DeprecationWarning: websockets.server.WebSocketServerProtocol is deprecated
  from websockets.server import WebSocketServerProtocol
INFO:     Started server process [8812]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8013 (Press CTRL+C to quit)
C:\Users\LEGION\Desktop\sec_agent\agents\defense_agent\attribution_agent.py:49: DeprecationWarning: websockets.client.connect is deprecated
  websockets.client.connect(
2025-08-08 17:08:00,021 - attribution-agent - INFO - ÒÑÁ¬½Óµ½ºó¶ËWebSocket: ws://localhost:8080/ws/logs
2025-08-08 17:08:00,357 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:08:12,321 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,322 - mcp.client.streamable_http - INFO - Received session ID: 2dfdf8034b1e4bcba237a4494c445737
2025-08-08 17:08:12,322 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:08:12,330 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:08:12,331 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,340 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,342 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,343 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,345 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:12,346 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:14,364 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:17,372 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m
Invoking: `analyze_attack_timeline` with `{'start_time': '2025-01-01T00:00:00', 'end_time': '2025-12-31T23:59:59'}`


[0m[32;1m[1;3m
Invoking: `trace_attack_path` with `{'source_node': 'internet', 'target_node': 'internal_db'}`


[0m[32;1m[1;3m
Invoking: `generate_threat_actor_profile` with `{'indicators': ['´ı·ÖÎö']}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'logs', 'target_system': 'internal_db'}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'network', 'target_system': 'internal_db'}`


[0m[33;1m[1;3m{
  "trace_id": "TRACE_682813",
  "source_node": "internet",
  "target_node": "internal_db",
  "path_found": true,
  "path_length": 4,
  "attack_path": [
    "internet",
    "firewall",
    "internal_switch",
    "internal_db"
  ],
  "path_analysis": [
    {
      "hop": 1,
      "from": "internet",
      "to": "firewall",
      "from_type": "external",
      "to_type": "security",
      "possible_techniques": [
        "¶Ë¿ÚÉ¨Ãè",
        "Â©¶´É¨Ãè",
        "·şÎñÃ¶¾Ù"
      ],
      "risk_level": "high"
    },
    {
      "hop": 2,
      "from": "firewall",
      "to": "internal_switch",
      "from_type": "security",
      "to_type": "network",
      "possible_techniques": [
        "·À»ğÇ½¹æÔòÈÆ¹ı",
        "VPNËíµÀ",
        "Ğ­ÒéËíµÀ"
      ],
      "risk_level": "high"
    },
    {
      "hop": 3,
      "from": "internal_switch",
      "to": "internal_db",
      "from_type": "network",
      "to_type": "server",
      "possible_techniques": [
        "ÍøÂçĞáÌ½",
        "ÖĞ¼äÈË¹¥»÷",
        "Á÷Á¿ÖØ¶¨Ïò"
      ],
      "risk_level": "low"
    }
  ],
  "overall_risk": "medium",
  "recommendations": [
    "¼ÓÇ¿ÍøÂç·Ö¶Î",
    "²¿ÊğÈëÇÖ¼ì²âÏµÍ³",
    "ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹",
    "¶¨ÆÚ½øĞĞÉøÍ¸²âÊÔ"
  ]
}[0m[36;1m[1;3m{
  "analysis_id": "TIMELINE_421091",
  "analysis_period": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-12-31T23:59:59"
  },
  "total_events": 9,
  "attack_duration": "8Ğ¡Ê±45·ÖÖÓ",
  "attack_stages": {
    "reconnaissance": 2,
    "weaponization": 1,
    "delivery": 1,
    "exploitation": 1,
    "installation": 1,
    "command_and_control": 1,
    "actions_on_objectives": 2
  },
  "events": [
    {
      "timestamp": "2025-08-07T17:23:15.353641",
      "stage": "reconnaissance",
      "event": "¶Ë¿ÚÉ¨Ãè»î¶¯",
      "source_ip": "203.0.113.100",
      "target": "firewall",
      "technique": "T1046 - Network Service Scanning",
      "confidence": 95
    },
    {
      "timestamp": "2025-08-07T17:38:15.353670",
      "stage": "reconnaissance",
      "event": "WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ",
      "source_ip": "203.0.113.100",
      "target": "dmz_web",
      "technique": "T1590 - Gather Victim Network Information",
      "confidence": 90
    },
    {
      "timestamp": "2025-08-07T18:53:15.353675",
      "stage": "weaponization",
      "event": "µöÓãÓÊ¼şÖÆ×÷",
      "source_ip": "unknown",
      "target": "pc_user",
      "technique": "T1566.001 - Spearphishing Attachment",
      "confidence": 85
    },
    {
      "timestamp": "2025-08-07T19:38:15.353679",
      "stage": "delivery",
      "event": "µöÓãÓÊ¼şÍ¶µİ",
      "source_ip": "198.51.100.50",
      "target": "pc_user",
      "technique": "T1566.002 - Spearphishing Link",
      "confidence": 92
    },
    {
      "timestamp": "2025-08-07T20:23:15.353683",
      "stage": "exploitation",
      "event": "¶ñÒâÁ´½Óµã»÷",
      "source_ip": "pc_user",
      "target": "198.51.100.50",
      "technique": "T1204.002 - Malicious File",
      "confidence": 88
    },
    {
      "timestamp": "2025-08-07T21:48:15.353686",
      "stage": "installation",
      "event": "ºóÃÅ³ÌĞò°²×°",
      "source_ip": "pc_user",
      "target": "pc_user",
      "technique": "T1547.001 - Registry Run Keys",
      "confidence": 94
    },
    {
      "timestamp": "2025-08-07T22:58:15.353688",
      "stage": "command_and_control",
      "event": "C2Í¨ĞÅ½¨Á¢",
      "source_ip": "pc_user",
      "target": "203.0.113.200",
      "technique": "T1071.001 - Web Protocols",
      "confidence": 96
    },
    {
      "timestamp": "2025-08-08T00:38:15.353691",
      "stage": "actions_on_objectives",
      "event": "ºáÏòÒÆ¶¯³¢ÊÔ",
      "source_ip": "pc_user",
      "target": "internal_db",
      "technique": "T1021.001 - Remote Desktop Protocol",
      "confidence": 89
    },
    {
      "timestamp": "2025-08-08T01:23:15.353695",
      "stage": "actions_on_objectives",
      "event": "Ãô¸ĞÊı¾İ·ÃÎÊ",
      "source_ip": "internal_db",
      "target": "internal_db",
      "technique": "T1005 - Data from Local System",
      "confidence": 91
    }
  ],
  "attack_path": [
    "internet ¡ú firewall (¶Ë¿ÚÉ¨Ãè)",
    "internet ¡ú dmz_web (WebÖ¸ÎÆÊ¶±ğ)",
    "internet ¡ú pc_user (µöÓãÓÊ¼ş)",
    "pc_user ¡ú C2·şÎñÆ÷ (½¨Á¢Í¨ĞÅ)",
    "pc_user ¡ú internal_db (ºáÏòÒÆ¶¯)",
    "internal_db ¡ú Êı¾İÇÔÈ¡"
  ],
  "key_indicators": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ]
}[0m[38;5;200m[1;3m{
  "profile_id": "PROFILE_749778",
  "analysis_date": "2025-08-08T17:08:16.364366",
  "indicators_analyzed": [
    "´ı·ÖÎö"
  ],
  "matched_actors": [],
  "primary_attribution": {
    "actor_name": "Î´ÖªÍşĞ²ĞĞÎªÕß",
    "confidence": 30,
    "origin": "Î´Öª",
    "motivation": "Î´È·¶¨",
    "target_sectors": [
      "¶àĞĞÒµ"
    ],
    "ttps": [
      "³£¼û¹¥»÷¼¼Êõ"
    ],
    "tools": [
      "Í¨ÓÃ¹¤¾ß"
    ]
  },
  "attack_sophistication": "ÖĞ",
  "campaign_assessment": {
    "campaign_type": "»ú»áÖ÷Òå¹¥»÷",
    "persistence_level": "ÖĞ",
    "stealth_level": "ÖĞµÈ",
    "resource_level": "ÓĞÏŞ"
  },
  "recommendations": [
    "¼ÓÇ¿ÍşĞ²Çé±¨ÊÕ¼¯",
    "²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "ÊµÊ©ĞĞÎª·ÖÎö¼à¿Ø",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÄÜÁ¦",
    "¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ"
  ]
}[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_780793",
  "evidence_type": "logs",
  "evidence_name": "ÏµÍ³ÈÕÖ¾",
  "target_system": "internal_db",
  "collection_started": "2025-08-08T17:08:17.357693",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:08:17.357703",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "system.log",
      "size_bytes": 79417865,
      "hash_sha256": "01c97bd5f46adcaf9494112b68a93e90bb587fe99e5ef1fc1b0b6edde4d0f692",
      "created_time": "2025-07-21T17:08:17.357728",
      "modified_time": "2025-08-08T16:08:17.357738"
    },
    {
      "filename": "security.log",
      "size_bytes": 44751676,
      "hash_sha256": "0d1318631c1d35e20b4f8498449b7aafb8e767c96dd44a031b62a179cdc279ea",
      "created_time": "2025-07-30T17:08:17.357752",
      "modified_time": "2025-08-08T01:08:17.357757"
    },
    {
      "filename": "application.log",
      "size_bytes": 24681522,
      "hash_sha256": "8d9ddd354e3952afd7a18b03bd87712f87fdcfeac34426ac090e52e2e87c0537",
      "created_time": "2025-07-27T17:08:17.357768",
      "modified_time": "2025-08-07T18:08:17.357771"
    },
    {
      "filename": "firewall.log",
      "size_bytes": 68479360,
      "hash_sha256": "1c4ebfe609c69334c96ae69b8078bb62a4e4a81e15307a76461bb9ce115cb696",
      "created_time": "2025-07-13T17:08:17.357782",
      "modified_time": "2025-08-08T07:08:17.357786"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:08:17.357790",
  "total_files": 4,
  "total_size_mb": 207.26244258880615
}[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_111789",
  "evidence_type": "network",
  "evidence_name": "ÍøÂçÁ÷Á¿",
  "target_system": "internal_db",
  "collection_started": "2025-08-08T17:08:17.359477",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:08:17.359489",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "network_capture.pcap",
      "size_bytes": 98961334,
      "hash_sha256": "8c72832c08f25024b48e52f0e6a5673e9e9c9d09c79767e4e5eef328a198992e",
      "created_time": "2025-08-07T17:08:17.359516",
      "modified_time": "2025-08-08T13:08:17.359605"
    },
    {
      "filename": "dns_queries.txt",
      "size_bytes": 60363180,
      "hash_sha256": "586de6b130582b81f7d9bc77fe032d449db92c30044fc7f8c41f3fddf180bd6c",
      "created_time": "2025-07-09T17:08:17.359639",
      "modified_time": "2025-08-08T15:08:17.359647"
    },
    {
      "filename": "http_requests.txt",
      "size_bytes": 22161534,
      "hash_sha256": "bd004269b7a9b7e6cf74f04e2c2c4eeb842ac48baae72235a85d6906510361f1",
      "created_time": "2025-08-01T17:08:17.359662",
      "modified_time": "2025-08-08T13:08:17.359666"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:08:17.359671",
  "total_files": 3,
  "total_size_mb": 173.07858276367188
}[0m2025-08-08 17:08:17,698 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:08:29,846 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:08:37,818 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:37,818 - mcp.client.streamable_http - INFO - Received session ID: ea61c65b6df14c0a9eff2aa8cb902104
2025-08-08 17:08:37,819 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:08:37,824 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:08:37,826 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:37,830 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:37,831 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:39,850 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:40,846 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:41,022 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:08:49,689 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:49,689 - mcp.client.streamable_http - INFO - Received session ID: af3f1c350eef431cbe14659f87579d1b
2025-08-08 17:08:49,690 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:08:49,696 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:08:49,697 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:49,704 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:49,708 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:49,709 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:52,720 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:52,723 - attribution-agent - WARNING - ·¢ËÍÏûÏ¢Ê§°Ü£¬³¢ÊÔÖØĞÂÁ¬½Ó: sent 1011 (internal error) keepalive ping timeout; no close frame received
C:\Users\LEGION\Desktop\sec_agent\agents\defense_agent\attribution_agent.py:49: DeprecationWarning: websockets.client.connect is deprecated
  websockets.client.connect(
2025-08-08 17:08:54,735 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:08:54,761 - attribution-agent - INFO - ÒÑÁ¬½Óµ½ºó¶ËWebSocket: ws://localhost:8080/ws/logs


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m
Invoking: `analyze_attack_timeline` with `{'start_time': '2025-01-01T00:00:00', 'end_time': '2025-12-31T23:59:59'}`


[0m[32;1m[1;3m
Invoking: `trace_attack_path` with `{'source_node': 'internet', 'target_node': 'internal_db'}`


[0m[33;1m[1;3m{
  "trace_id": "TRACE_383729",
  "source_node": "internet",
  "target_node": "internal_db",
  "path_found": true,
  "path_length": 4,
  "attack_path": [
    "internet",
    "firewall",
    "internal_switch",
    "internal_db"
  ],
  "path_analysis": [
    {
      "hop": 1,
      "from": "internet",
      "to": "firewall",
      "from_type": "external",
      "to_type": "security",
      "possible_techniques": [
        "¶Ë¿ÚÉ¨Ãè",
        "Â©¶´É¨Ãè",
        "·şÎñÃ¶¾Ù"
      ],
      "risk_level": "critical"
    },
    {
      "hop": 2,
      "from": "firewall",
      "to": "internal_switch",
      "from_type": "security",
      "to_type": "network",
      "possible_techniques": [
        "·À»ğÇ½¹æÔòÈÆ¹ı",
        "VPNËíµÀ",
        "Ğ­ÒéËíµÀ"
      ],
      "risk_level": "critical"
    },
    {
      "hop": 3,
      "from": "internal_switch",
      "to": "internal_db",
      "from_type": "network",
      "to_type": "server",
      "possible_techniques": [
        "ÍøÂçĞáÌ½",
        "ÖĞ¼äÈË¹¥»÷",
        "Á÷Á¿ÖØ¶¨Ïò"
      ],
      "risk_level": "critical"
    }
  ],
  "overall_risk": "medium",
  "recommendations": [
    "¼ÓÇ¿ÍøÂç·Ö¶Î",
    "²¿ÊğÈëÇÖ¼ì²âÏµÍ³",
    "ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹",
    "¶¨ÆÚ½øĞĞÉøÍ¸²âÊÔ"
  ]
}[0m[36;1m[1;3m{
  "analysis_id": "TIMELINE_530847",
  "analysis_period": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-12-31T23:59:59"
  },
  "total_events": 9,
  "attack_duration": "8Ğ¡Ê±45·ÖÖÓ",
  "attack_stages": {
    "reconnaissance": 2,
    "weaponization": 1,
    "delivery": 1,
    "exploitation": 1,
    "installation": 1,
    "command_and_control": 1,
    "actions_on_objectives": 2
  },
  "events": [
    {
      "timestamp": "2025-08-07T17:23:40.838745",
      "stage": "reconnaissance",
      "event": "¶Ë¿ÚÉ¨Ãè»î¶¯",
      "source_ip": "203.0.113.100",
      "target": "firewall",
      "technique": "T1046 - Network Service Scanning",
      "confidence": 95
    },
    {
      "timestamp": "2025-08-07T17:38:40.838772",
      "stage": "reconnaissance",
      "event": "WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ",
      "source_ip": "203.0.113.100",
      "target": "dmz_web",
      "technique": "T1590 - Gather Victim Network Information",
      "confidence": 90
    },
    {
      "timestamp": "2025-08-07T18:53:40.838780",
      "stage": "weaponization",
      "event": "µöÓãÓÊ¼şÖÆ×÷",
      "source_ip": "unknown",
      "target": "pc_user",
      "technique": "T1566.001 - Spearphishing Attachment",
      "confidence": 85
    },
    {
      "timestamp": "2025-08-07T19:38:40.838784",
      "stage": "delivery",
      "event": "µöÓãÓÊ¼şÍ¶µİ",
      "source_ip": "198.51.100.50",
      "target": "pc_user",
      "technique": "T1566.002 - Spearphishing Link",
      "confidence": 92
    },
    {
      "timestamp": "2025-08-07T20:23:40.838787",
      "stage": "exploitation",
      "event": "¶ñÒâÁ´½Óµã»÷",
      "source_ip": "pc_user",
      "target": "198.51.100.50",
      "technique": "T1204.002 - Malicious File",
      "confidence": 88
    },
    {
      "timestamp": "2025-08-07T21:48:40.838791",
      "stage": "installation",
      "event": "ºóÃÅ³ÌĞò°²×°",
      "source_ip": "pc_user",
      "target": "pc_user",
      "technique": "T1547.001 - Registry Run Keys",
      "confidence": 94
    },
    {
      "timestamp": "2025-08-07T22:58:40.838794",
      "stage": "command_and_control",
      "event": "C2Í¨ĞÅ½¨Á¢",
      "source_ip": "pc_user",
      "target": "203.0.113.200",
      "technique": "T1071.001 - Web Protocols",
      "confidence": 96
    },
    {
      "timestamp": "2025-08-08T00:38:40.838797",
      "stage": "actions_on_objectives",
      "event": "ºáÏòÒÆ¶¯³¢ÊÔ",
      "source_ip": "pc_user",
      "target": "internal_db",
      "technique": "T1021.001 - Remote Desktop Protocol",
      "confidence": 89
    },
    {
      "timestamp": "2025-08-08T01:23:40.838800",
      "stage": "actions_on_objectives",
      "event": "Ãô¸ĞÊı¾İ·ÃÎÊ",
      "source_ip": "internal_db",
      "target": "internal_db",
      "technique": "T1005 - Data from Local System",
      "confidence": 91
    }
  ],
  "attack_path": [
    "internet ¡ú firewall (¶Ë¿ÚÉ¨Ãè)",
    "internet ¡ú dmz_web (WebÖ¸ÎÆÊ¶±ğ)",
    "internet ¡ú pc_user (µöÓãÓÊ¼ş)",
    "pc_user ¡ú C2·şÎñÆ÷ (½¨Á¢Í¨ĞÅ)",
    "pc_user ¡ú internal_db (ºáÏòÒÆ¶¯)",
    "internal_db ¡ú Êı¾İÇÔÈ¡"
  ],
  "key_indicators": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ]
}[0m[32;1m[1;3m
Invoking: `generate_incident_report` with `{'incident_id': 'INC_183274', 'incident_type': 'apt_attack'}`
responded: ### ËİÔ´·ÖÎö½á¹û

#### 1. ¹¥»÷Ê±¼äÏß·ÖÎö
- **¹¥»÷³ÖĞøÊ±¼ä**£º8Ğ¡Ê±45·ÖÖÓ
- **¹¥»÷½×¶Î**£º
  - **Õì²ì½×¶Î**£º¹¥»÷Õß½øĞĞÁË¶Ë¿ÚÉ¨ÃèºÍWebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ¡£
  - **ÎäÆ÷»¯½×¶Î**£ºÖÆ×÷ÁËµöÓãÓÊ¼ş¡£
  - **Í¶µİ½×¶Î**£ºÍ¨¹ıµöÓãÓÊ¼şÍ¶µİ¶ñÒâÁ´½Ó¡£
  - **ÀûÓÃ½×¶Î**£ºÓÃ»§µã»÷¶ñÒâÁ´½Ó¡£
  - **°²×°½×¶Î**£ººóÃÅ³ÌĞò°²×°¡£
  - **ÃüÁîÓë¿ØÖÆ½×¶Î**£º½¨Á¢ÁËC2Í¨ĞÅ¡£
  - **Ä¿±êĞĞ¶¯½×¶Î**£ººáÏòÒÆ¶¯µ½ÄÚ²¿Êı¾İ¿â²¢ÇÔÈ¡Êı¾İ¡£
- **¹Ø¼üÊÂ¼ş**£º
  - ³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ¡£
  - ¹¥»÷Õß³É¹¦½¨Á¢ÁË³Ö¾Ã»¯·ÃÎÊ²¢ºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú¡£

#### 2. ¹¥»÷Â·¾¶×·×Ù
- **Â·¾¶**£º`internet ¡ú firewall ¡ú internal_switch ¡ú internal_db`
- **·çÏÕ·ÖÎö**£º
  - **¸ß·çÏÕ**£º·À»ğÇ½¹æÔòÈÆ¹ıºÍVPNËíµÀÊ¹ÓÃ¡£
  - **µÍ·çÏÕ**£ºÍøÂçĞáÌ½ºÍÁ÷Á¿ÖØ¶¨Ïò¡£
- **½¨Òé**£º
  - ¼ÓÇ¿ÍøÂç·Ö¶Î¡£
  - ²¿ÊğÈëÇÖ¼ì²âÏµÍ³¡£
  - ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹¡£

#### 3. ÍşĞ²ĞĞÎªÕß»­Ïñ
- **ÍşĞ²ĞĞÎªÕß**£ºÎ´ÖªÍşĞ²ĞĞÎªÕß
- **¶¯»ú**£ºÎ´È·¶¨
- **¹¥»÷¼¼Êõ**£º³£¼û¹¥»÷¼¼Êõ
- **½¨Òé**£º
  - ¼ÓÇ¿ÍşĞ²Çé±¨ÊÕ¼¯¡£
  - ²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³¡£
  - ÊµÊ©ĞĞÎª·ÖÎö¼à¿Ø¡£

#### 4. Êı×ÖÖ¤¾İÊÕ¼¯
- **ÈÕÖ¾Ö¤¾İ**£º³É¹¦ÊÕ¼¯ÁËÏµÍ³ÈÕÖ¾¡¢°²È«ÈÕÖ¾¡¢Ó¦ÓÃÈÕÖ¾ºÍ·À»ğÇ½ÈÕÖ¾¡£
- **ÍøÂçÖ¤¾İ**£º³É¹¦ÊÕ¼¯ÁËÍøÂçÁ÷Á¿²¶»ñ¡¢DNS²éÑ¯ºÍHTTPÇëÇó¼ÇÂ¼¡£
- **Ö¤¾İÍêÕûĞÔ**£ºËùÓĞÖ¤¾İ¾ùÍ¨¹ıSHA-256¹şÏ£ÑéÖ¤¡£

#### 5. ¶ñÒâÈí¼ş·ÖÎö
- Î´·¢ÏÖ¶ñÒâÈí¼şÑù±¾£¬ÎŞĞè½øÒ»²½·ÖÎö¡£

#### 6. ×ÛºÏÊÂ¼ş±¨¸æ
½ÓÏÂÀ´½«Éú³É×ÛºÏÊÂ¼ş±¨¸æ£¬°üÀ¨ÏêÏ¸µÄ·ÖÎö½á¹ûºÍ½¨Òé´ëÊ©¡£

[0m[32;1m[1;3m
Invoking: `generate_threat_actor_profile` with `{'indicators': ['¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ', '³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ', '³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ', 'ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú', '´æÔÚÊı¾İÇÔÈ¡ĞĞÎª']}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'logs, network', 'target_system': 'internal_db'}`


[0m[33;1m[1;3m{
  "report_id": "INCIDENT_144102",
  "incident_id": "INC_183274",
  "incident_type": "apt_attack",
  "incident_name": "¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
  "report_generated": "2025-08-08T17:08:52.712862",
  "executive_summary": {
    "incident_overview": "¼ì²âµ½Õë¶Ô×éÖ¯µÄ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
    "impact_assessment": "ÖĞµÈµ½¸ßµÈÓ°Ïì",
    "current_status": "ÒÑ¿ØÖÆ",
    "estimated_cost": "$158,267"
  },
  "timeline": {
    "first_detection": "2025-08-07T17:08:52.712880",
    "incident_declared": "2025-08-07T18:08:52.712891",
    "containment_achieved": "2025-08-07T23:08:52.712895",
    "eradication_completed": "2025-08-08T05:08:52.712898",
    "recovery_started": "2025-08-08T11:08:52.712901"
  },
  "affected_systems": [
    {
      "system": "dmz_web",
      "impact": "¸ß",
      "status": "ÒÑ»Ö¸´"
    },
    {
      "system": "internal_db",
      "impact": "ÖĞ",
      "status": "¼à¿ØÖĞ"
    },
    {
      "system": "pc_user",
      "impact": "¸ß",
      "status": "ÒÑÖØ½¨"
    }
  ],
  "attack_vectors": [
    "µöÓãÓÊ¼ş",
    "WebÓ¦ÓÃÂ©¶´",
    "ºáÏòÒÆ¶¯",
    "È¨ÏŞÌáÉı"
  ],
  "evidence_collected": [
    "ÏµÍ³ÈÕÖ¾ (50GB)",
    "ÍøÂçÁ÷Á¿²¶»ñ (200GB)",
    "ÄÚ´æ¾µÏñ (32GB)",
    "¶ñÒâÈí¼şÑù±¾ (15¸ö)"
  ],
  "lessons_learned": [
    "ĞèÒª¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ",
    "Ó¦ÊµÊ©¸üÑÏ¸ñµÄÍøÂç·Ö¶Î",
    "ĞèÒª²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "Ó¦½¨Á¢¸üÍêÉÆµÄÊÂ¼şÏìÓ¦Á÷³Ì"
  ],
  "recommendations": [
    "ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹",
    "²¿ÊğEDR½â¾ö·½°¸",
    "¼ÓÇ¿ÍşĞ²Çé±¨ÄÜÁ¦",
    "¶¨ÆÚ½øĞĞ°²È«ÑİÁ·",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÍÅ¶Ó"
  ]
}[0m2025-08-08 17:08:55,071 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:08:55,772 - attribution-agent - INFO - ÒÑÁ¬½Óµ½ºó¶ËWebSocket: ws://localhost:8080/ws/logs
2025-08-08 17:08:56,768 - attribution-agent - INFO - ÒÑÁ¬½Óµ½ºó¶ËWebSocket: ws://localhost:8080/ws/logs
2025-08-08 17:08:56,991 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:09:04,500 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:04,500 - mcp.client.streamable_http - INFO - Received session ID: c1e800ffeec24b99b5a3dc4d56657e46
2025-08-08 17:09:04,501 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:09:04,507 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:09:04,508 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:04,514 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:04,517 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:09,544 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:09,545 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:09,555 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:09,890 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:09:16,419 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:16,419 - mcp.client.streamable_http - INFO - Received session ID: d1208a9a79b14c1286c6b27dcc7d9282
2025-08-08 17:09:16,420 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:09:16,426 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:09:16,428 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:16,431 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:19,444 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:19,450 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:19,566 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:09:32,946 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:09:41,050 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:41,050 - mcp.client.streamable_http - INFO - Received session ID: a3e5fbbf14ea46638b83e3e7d35414af
2025-08-08 17:09:41,051 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:09:41,056 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:09:41,056 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:41,062 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:41,064 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:43,087 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:44,085 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
[38;5;200m[1;3m{
  "profile_id": "PROFILE_282085",
  "analysis_date": "2025-08-08T17:08:53.721793",
  "indicators_analyzed": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ],
  "matched_actors": [],
  "primary_attribution": {
    "actor_name": "Î´ÖªÍşĞ²ĞĞÎªÕß",
    "confidence": 30,
    "origin": "Î´Öª",
    "motivation": "Î´È·¶¨",
    "target_sectors": [
      "¶àĞĞÒµ"
    ],
    "ttps": [
      "³£¼û¹¥»÷¼¼Êõ"
    ],
    "tools": [
      "Í¨ÓÃ¹¤¾ß"
    ]
  },
  "attack_sophistication": "¼«¸ß",
  "campaign_assessment": {
    "campaign_type": "»ú»áÖ÷Òå¹¥»÷",
    "persistence_level": "ÖĞ",
    "stealth_level": "ÖĞµÈ",
    "resource_level": "ÓĞÏŞ"
  },
  "recommendations": [
    "¼ÓÇ¿ÍşĞ²Çé±¨ÊÕ¼¯",
    "²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "ÊµÊ©ĞĞÎª·ÖÎö¼à¿Ø",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÄÜÁ¦",
    "¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ"
  ]
}[0m[31;1m[1;3m{"error": "Î´ÖªÖ¤¾İÀàĞÍ: logs, network"}[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'logs', 'target_system': 'internal_db'}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'network', 'target_system': 'internal_db'}`


[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_595429",
  "evidence_type": "logs",
  "evidence_name": "ÏµÍ³ÈÕÖ¾",
  "target_system": "internal_db",
  "collection_started": "2025-08-08T17:09:09.531860",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:09:09.531870",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "system.log",
      "size_bytes": 101781810,
      "hash_sha256": "d87be16bc931eba94d5b0943538d98aeaf2d6cc45a5f6144100b46276dcbe5ee",
      "created_time": "2025-07-22T17:09:09.531894",
      "modified_time": "2025-08-07T21:09:09.531908"
    },
    {
      "filename": "security.log",
      "size_bytes": 61529648,
      "hash_sha256": "3cbcbd5bb1b5e986c041fa30c8d46e87e2fa2714a3e415638624d198c8d9386b",
      "created_time": "2025-08-05T17:09:09.531926",
      "modified_time": "2025-08-07T21:09:09.531930"
    },
    {
      "filename": "application.log",
      "size_bytes": 71471382,
      "hash_sha256": "52900d8b95448c2ff3d03d5a4bb21d71ebd4eb063562296ca02acf830b3f5560",
      "created_time": "2025-07-17T17:09:09.531940",
      "modified_time": "2025-08-08T03:09:09.531943"
    },
    {
      "filename": "firewall.log",
      "size_bytes": 88070040,
      "hash_sha256": "fcb612a158bf4cec348e0ff53714de0901efff59956803cb36442d446c142538",
      "created_time": "2025-07-23T17:09:09.531960",
      "modified_time": "2025-08-08T07:09:09.531966"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:09:09.531970",
  "total_files": 4,
  "total_size_mb": 307.89649963378906
}[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_163738",
  "evidence_type": "network",
  "evidence_name": "ÍøÂçÁ÷Á¿",
  "target_system": "internal_db",
  "collection_started": "2025-08-08T17:09:09.533459",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:09:09.533464",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "network_capture.pcap",
      "size_bytes": 7028658,
      "hash_sha256": "f556ca09621550bd83729cc42fc9be23f57661874376e66a45aeaa2ac88b463c",
      "created_time": "2025-07-27T17:09:09.533491",
      "modified_time": "2025-08-08T06:09:09.533498"
    },
    {
      "filename": "dns_queries.txt",
      "size_bytes": 29714251,
      "hash_sha256": "25d3d401a31d0b3dfccb73916fb006f89a672d08838cf8e4237f733bc338dff6",
      "created_time": "2025-08-07T17:09:09.533509",
      "modified_time": "2025-08-07T17:09:09.533513"
    },
    {
      "filename": "http_requests.txt",
      "size_bytes": 29558754,
      "hash_sha256": "5eeac64e1e349918b33432f9a42c639c1bfec9f748f229cf578f45fd8f6079b1",
      "created_time": "2025-08-03T17:09:09.533524",
      "modified_time": "2025-08-07T23:09:09.533526"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:09:09.533529",
  "total_files": 3,
  "total_size_mb": 63.23019313812256
}[0m[32;1m[1;3m
Invoking: `generate_incident_report` with `{'incident_id': 'INC_183305', 'incident_type': 'apt_attack'}`


[0m[33;1m[1;3m{
  "report_id": "INCIDENT_260436",
  "incident_id": "INC_183305",
  "incident_type": "apt_attack",
  "incident_name": "¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
  "report_generated": "2025-08-08T17:09:19.437145",
  "executive_summary": {
    "incident_overview": "¼ì²âµ½Õë¶Ô×éÖ¯µÄ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
    "impact_assessment": "ÖĞµÈµ½¸ßµÈÓ°Ïì",
    "current_status": "ÒÑ¿ØÖÆ",
    "estimated_cost": "$89,763"
  },
  "timeline": {
    "first_detection": "2025-08-07T17:09:19.437168",
    "incident_declared": "2025-08-07T18:09:19.437177",
    "containment_achieved": "2025-08-07T23:09:19.437180",
    "eradication_completed": "2025-08-08T05:09:19.437183",
    "recovery_started": "2025-08-08T11:09:19.437185"
  },
  "affected_systems": [
    {
      "system": "dmz_web",
      "impact": "¸ß",
      "status": "ÒÑ»Ö¸´"
    },
    {
      "system": "internal_db",
      "impact": "ÖĞ",
      "status": "¼à¿ØÖĞ"
    },
    {
      "system": "pc_user",
      "impact": "¸ß",
      "status": "ÒÑÖØ½¨"
    }
  ],
  "attack_vectors": [
    "µöÓãÓÊ¼ş",
    "WebÓ¦ÓÃÂ©¶´",
    "ºáÏòÒÆ¶¯",
    "È¨ÏŞÌáÉı"
  ],
  "evidence_collected": [
    "ÏµÍ³ÈÕÖ¾ (50GB)",
    "ÍøÂçÁ÷Á¿²¶»ñ (200GB)",
    "ÄÚ´æ¾µÏñ (32GB)",
    "¶ñÒâÈí¼şÑù±¾ (15¸ö)"
  ],
  "lessons_learned": [
    "ĞèÒª¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ",
    "Ó¦ÊµÊ©¸üÑÏ¸ñµÄÍøÂç·Ö¶Î",
    "ĞèÒª²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "Ó¦½¨Á¢¸üÍêÉÆµÄÊÂ¼şÏìÓ¦Á÷³Ì"
  ],
  "recommendations": [
    "ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹",
    "²¿ÊğEDR½â¾ö·½°¸",
    "¼ÓÇ¿ÍşĞ²Çé±¨ÄÜÁ¦",
    "¶¨ÆÚ½øĞĞ°²È«ÑİÁ·",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÍÅ¶Ó"
  ]
}[0m[32;1m[1;3m### ×ÛºÏÊÂ¼ş·ÖÎö±¨¸æ

#### **ÊÂ¼ş¸ÅÊö**
- **ÊÂ¼şID**: INC_183274
- **ÊÂ¼şÀàĞÍ**: ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷ (APT)
- **Ó°ÏìÆÀ¹À**: ÖĞµÈµ½¸ßµÈÓ°Ïì
- **µ±Ç°×´Ì¬**: ÒÑ¿ØÖÆ
- **Ô¤¹ÀËğÊ§**: $158,267

#### **Ê±¼äÏß**
- **Ê×´Î¼ì²â**: 2025-08-07T17:08:52
- **ÊÂ¼şĞû¸æ**: 2025-08-07T18:08:52
- **¿ØÖÆ´ï³É**: 2025-08-07T23:08:52
- **Çå³ıÍê³É**: 2025-08-08T05:08:52
- **»Ö¸´¿ªÊ¼**: 2025-08-08T11:08:52

#### **ÊÜÓ°ÏìÏµÍ³**
1. **DMZ Web·şÎñÆ÷**
   - Ó°Ïì: ¸ß
   - ×´Ì¬: ÒÑ»Ö¸´
2. **ÄÚ²¿Êı¾İ¿â**
   - Ó°Ïì: ÖĞ
   - ×´Ì¬: ¼à¿ØÖĞ
3. **ÓÃ»§ÖÕ¶Ë**
   - Ó°Ïì: ¸ß
   - ×´Ì¬: ÒÑÖØ½¨

#### **¹¥»÷ÏòÁ¿**
- µöÓãÓÊ¼ş
- WebÓ¦ÓÃÂ©¶´
- ºáÏòÒÆ¶¯
- È¨ÏŞÌáÉı

#### **ÊÕ¼¯µÄÖ¤¾İ**
- ÏµÍ³ÈÕÖ¾ (50GB)
- ÍøÂçÁ÷Á¿²¶»ñ (200GB)
- ÄÚ´æ¾µÏñ (32GB)
- ¶ñÒâÈí¼şÑù±¾ (15¸ö)

#### **¾­Ñé½ÌÑµ**
1. ĞèÒª¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ¡£
2. Ó¦ÊµÊ©¸üÑÏ¸ñµÄÍøÂç·Ö¶Î¡£
3. ĞèÒª²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³¡£
4. Ó¦½¨Á¢¸üÍêÉÆµÄÊÂ¼şÏìÓ¦Á÷³Ì¡£

#### **·À»¤½¨Òé**
1. **ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹**£ºÏŞÖÆÄÚ²¿ºáÏòÒÆ¶¯¡£
2. **²¿ÊğEDR½â¾ö·½°¸**£ºÔöÇ¿ÖÕ¶Ë¼ì²âºÍÏìÓ¦ÄÜÁ¦¡£
3. **¼ÓÇ¿ÍşĞ²Çé±¨ÄÜÁ¦**£º¼°Ê±»ñÈ¡×îĞÂµÄÍşĞ²ĞÅÏ¢¡£
4. **¶¨ÆÚ½øĞĞ°²È«ÑİÁ·**£ºÌáÉıÍÅ¶ÓÓ¦¶ÔÄÜÁ¦¡£
5. **½¨Á¢ÍşĞ²ÁÔÉ±ÍÅ¶Ó**£ºÖ÷¶¯·¢ÏÖÇ±ÔÚÍşĞ²¡£

#### **ÏÂÒ»²½ĞĞ¶¯**
- ³ÖĞø¼à¿ØÊÜÓ°ÏìÏµÍ³µÄ»Ö¸´Çé¿ö¡£
- ¶¨ÆÚÉó²é°²È«²ßÂÔµÄÓĞĞ§ĞÔ¡£
- ¸üĞÂ·À»¤´ëÊ©ÒÔÓ¦¶ÔÀàËÆ¹¥»÷¡£

ÈçĞè½øÒ»²½·ÖÎö»òÖ§³Ö£¬ÇëËæÊ±ÁªÏµ¡£[0m

[1m> Finished chain.[0m


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m
Invoking: `analyze_attack_timeline` with `{'start_time': '2025-01-01T00:00:00', 'end_time': '2025-12-31T23:59:59'}`


[0m[32;1m[1;3m
Invoking: `trace_attack_path` with `{'source_node': 'internet', 'target_node': '-'}`


[0m[33;1m[1;3m{"error": "ÎŞ·¨ÕÒµ½´Ó internet µ½ - µÄÂ·¾¶"}[0m[36;1m[1;3m{
  "analysis_id": "TIMELINE_915833",
  "analysis_period": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-12-31T23:59:59"
  },
  "total_events": 9,
  "attack_duration": "8Ğ¡Ê±45·ÖÖÓ",
  "attack_stages": {
    "reconnaissance": 2,
    "weaponization": 1,
    "delivery": 1,
    "exploitation": 1,
    "installation": 1,
    "command_and_control": 1,
    "actions_on_objectives": 2
  },
  "events": [
    {
      "timestamp": "2025-08-07T17:24:44.075446",
      "stage": "reconnaissance",
      "event": "¶Ë¿ÚÉ¨Ãè»î¶¯",
      "source_ip": "203.0.113.100",
      "target": "firewall",
      "technique": "T1046 - Network Service Scanning",
      "confidence": 95
    },
    {
      "timestamp": "2025-08-07T17:39:44.075475",
      "stage": "reconnaissance",
      "event": "WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ",
      "source_ip": "203.0.113.100",
      "target": "dmz_web",
      "technique": "T1590 - Gather Victim Network Information",
      "confidence": 90
    },
    {
      "timestamp": "2025-08-07T18:54:44.075482",
      "stage": "weaponization",
      "event": "µöÓãÓÊ¼şÖÆ×÷",
      "source_ip": "unknown",
      "target": "pc_user",
      "technique": "T1566.001 - Spearphishing Attachment",
      "confidence": 85
    },
    {
      "timestamp": "2025-08-07T19:39:44.075488",
      "stage": "delivery",
      "event": "µöÓãÓÊ¼şÍ¶µİ",
      "source_ip": "198.51.100.50",
      "target": "pc_user",
      "technique": "T1566.002 - Spearphishing Link",
      "confidence": 92
    },
    {
      "timestamp": "2025-08-07T20:24:44.075494",
      "stage": "exploitation",
      "event": "¶ñÒâÁ´½Óµã»÷",
      "source_ip": "pc_user",
      "target": "198.51.100.50",
      "technique": "T1204.002 - Malicious File",
      "confidence": 88
    },
    {
      "timestamp": "2025-08-07T21:49:44.075499",
      "stage": "installation",
      "event": "ºóÃÅ³ÌĞò°²×°",
      "source_ip": "pc_user",
      "target": "pc_user",
      "technique": "T1547.001 - Registry Run Keys",
      "confidence": 94
    },
    {
      "timestamp": "2025-08-07T22:59:44.075502",
      "stage": "command_and_control",
      "event": "C2Í¨ĞÅ½¨Á¢",
      "source_ip": "pc_user",
      "target": "203.0.113.200",
      "technique": "T1071.001 - Web Protocols",
      "confidence": 96
    },
    {
      "timestamp": "2025-08-08T00:39:44.075505",
      "stage": "actions_on_objectives",
      "event": "ºáÏòÒÆ¶¯³¢ÊÔ",
      "source_ip": "pc_user",
      "target": "internal_db",
      "technique": "T1021.001 - Remote Desktop Protocol",
      "confidence": 89
    },
    {
      "timestamp": "2025-08-08T01:24:44.075508",
      "stage": "actions_on_objectives",
      "event": "Ãô¸ĞÊı¾İ·ÃÎÊ",
      "source_ip": "internal_db",
      "target": "internal_db",
      "technique": "T1005 - Data from Local System",
      "confidence": 91
    }
  ],
  "attack_path": [
    "internet ¡ú firewall (¶Ë¿ÚÉ¨Ãè)",
    "internet ¡ú dmz_web (WebÖ¸ÎÆÊ¶±ğ)",
    "internet ¡ú pc_user (µöÓãÓÊ¼ş)",
    "pc_user ¡ú C2·şÎñÆ÷ (½¨Á¢Í¨ĞÅ)",
    "pc_user ¡ú internal_db (ºáÏòÒÆ¶¯)",
    "internal_db ¡ú Êı¾İÇÔÈ¡"
  ],
  "key_indicators": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ]
}[0m2025-08-08 17:09:44,205 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:09:53,436 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:53,437 - mcp.client.streamable_http - INFO - Received session ID: b2ed6574e48948fbaedbd5c12011a8d7
2025-08-08 17:09:53,437 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:09:53,443 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:09:53,444 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:53,449 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:53,450 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:57,468 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:58,466 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:09:58,719 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:10:06,347 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:06,347 - mcp.client.streamable_http - INFO - Received session ID: f1af154b639c46aba2b68511c46e2a3e
2025-08-08 17:10:06,348 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:10:06,354 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:10:06,357 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:06,361 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:06,363 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:11,387 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:11,388 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:11,399 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:11,660 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:10:16,944 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:16,944 - mcp.client.streamable_http - INFO - Received session ID: 00989c492ab2499a8b2d8f1ed3b06eaa
2025-08-08 17:10:16,945 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:10:16,955 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:10:16,956 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:16,959 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:19,975 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:19,983 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:10:20,110 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
[32;1m[1;3m### ÊÂ¼ş·ÖÎö±¨¸æ£ºINC_183305

#### 1. **¹¥»÷Ê±¼äÏß·ÖÎö**
- **¹¥»÷³ÖĞøÊ±¼ä**: 8Ğ¡Ê±45·ÖÖÓ
- **¹¥»÷½×¶Î**:
  - **Õì²ì½×¶Î**: ¶Ë¿ÚÉ¨ÃèºÍWebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ
  - **ÎäÆ÷»¯½×¶Î**: µöÓãÓÊ¼şÖÆ×÷
  - **Í¶µİ½×¶Î**: µöÓãÓÊ¼şÍ¶µİ
  - **ÀûÓÃ½×¶Î**: ¶ñÒâÁ´½Óµã»÷
  - **°²×°½×¶Î**: ºóÃÅ³ÌĞò°²×°
  - **ÃüÁîÓë¿ØÖÆ½×¶Î**: C2Í¨ĞÅ½¨Á¢
  - **Ä¿±êĞĞ¶¯½×¶Î**: ºáÏòÒÆ¶¯ºÍÊı¾İÇÔÈ¡

#### 2. **¹¥»÷Â·¾¶×·×Ù**
- **Â·¾¶**: `internet ¡ú firewall ¡ú internal_switch ¡ú internal_db`
- **¹Ø¼ü½Úµã**:
  - **·À»ğÇ½**: ¹¥»÷ÕßÈÆ¹ı·À»ğÇ½¹æÔò
  - **ÄÚ²¿½»»»»ú**: ¿ÉÄÜÍ¨¹ıÖĞ¼äÈË¹¥»÷»òÁ÷Á¿ÖØ¶¨Ïò
  - **ÄÚ²¿Êı¾İ¿â**: ×îÖÕÄ¿±ê£¬Êı¾İ±»ÇÔÈ¡

#### 3. **ÍşĞ²ĞĞÎªÕß»­Ïñ**
- **¹¥»÷ÕßÌØÕ÷**:
  - Ê¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ
  - ³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ
  - ³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ
  - ºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú
  - ´æÔÚÊı¾İÇÔÈ¡ĞĞÎª
- **¹¥»÷ÕßÉí·İ**: Î´ÖªÍşĞ²ĞĞÎªÕß£¬¶¯»úÎ´Ã÷È·
- **¹¥»÷¸´ÔÓ¶È**: ¼«¸ß

#### 4. **Êı×ÖÖ¤¾İÊÕ¼¯**
- **ÈÕÖ¾Ö¤¾İ**:
  - ÏµÍ³ÈÕÖ¾¡¢°²È«ÈÕÖ¾¡¢Ó¦ÓÃÈÕÖ¾¡¢·À»ğÇ½ÈÕÖ¾
  - ×Ü´óĞ¡: 307.9 MB
- **ÍøÂçÖ¤¾İ**:
  - ÍøÂçÁ÷Á¿²¶»ñ¡¢DNS²éÑ¯¼ÇÂ¼¡¢HTTPÇëÇó¼ÇÂ¼
  - ×Ü´óĞ¡: 63.2 MB

#### 5. **·À»¤½¨Òé**
- **¼¼Êõ´ëÊ©**:
  - ¼ÓÇ¿ÍøÂç·Ö¶Î
  - ²¿ÊğÈëÇÖ¼ì²âÏµÍ³
  - ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹
  - ¶¨ÆÚ½øĞĞÉøÍ¸²âÊÔ
- **¹ÜÀí´ëÊ©**:
  - ¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ
  - ½¨Á¢ÍşĞ²ÁÔÉ±ÄÜÁ¦
  - ²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³

#### 6. **×ÛºÏ±¨¸æ**
- **ÊÂ¼şÀàĞÍ**: ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷
- **Ó°ÏìÆÀ¹À**: ÖĞµÈµ½¸ßµÈÓ°Ïì
- **µ±Ç°×´Ì¬**: ÒÑ¿ØÖÆ
- **¹Ø¼ü½ÌÑµ**:
  - ĞèÒª¼ÓÇ¿°²È«ÒâÊ¶ÅàÑµ
  - Ó¦ÊµÊ©¸üÑÏ¸ñµÄÍøÂç·Ö¶Î
  - ²¿ÊğEDR½â¾ö·½°¸

ÈçĞè½øÒ»²½·ÖÎö»ò²ÉÈ¡ĞĞ¶¯£¬Çë¸æÖª£¡[0m

[1m> Finished chain.[0m
[32;1m[1;3m
Invoking: `generate_threat_actor_profile` with `{'indicators': ['¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ', '³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ', '³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ', 'ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú', '´æÔÚÊı¾İÇÔÈ¡ĞĞÎª']}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'logs, network', 'target_system': 'pc_user, internal_db'}`


[0m[38;5;200m[1;3m{
  "profile_id": "PROFILE_430330",
  "analysis_date": "2025-08-08T17:09:57.459583",
  "indicators_analyzed": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ],
  "matched_actors": [],
  "primary_attribution": {
    "actor_name": "Î´ÖªÍşĞ²ĞĞÎªÕß",
    "confidence": 30,
    "origin": "Î´Öª",
    "motivation": "Î´È·¶¨",
    "target_sectors": [
      "¶àĞĞÒµ"
    ],
    "ttps": [
      "³£¼û¹¥»÷¼¼Êõ"
    ],
    "tools": [
      "Í¨ÓÃ¹¤¾ß"
    ]
  },
  "attack_sophistication": "ÖĞ",
  "campaign_assessment": {
    "campaign_type": "»ú»áÖ÷Òå¹¥»÷",
    "persistence_level": "ÖĞ",
    "stealth_level": "ÖĞµÈ",
    "resource_level": "ÓĞÏŞ"
  },
  "recommendations": [
    "¼ÓÇ¿ÍşĞ²Çé±¨ÊÕ¼¯",
    "²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "ÊµÊ©ĞĞÎª·ÖÎö¼à¿Ø",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÄÜÁ¦",
    "¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ"
  ]
}[0m[31;1m[1;3m{"error": "Î´ÖªÖ¤¾İÀàĞÍ: logs, network"}[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'logs', 'target_system': 'pc_user'}`


[0m[32;1m[1;3m
Invoking: `collect_digital_evidence` with `{'evidence_type': 'network', 'target_system': 'internal_db'}`


[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_552229",
  "evidence_type": "logs",
  "evidence_name": "ÏµÍ³ÈÕÖ¾",
  "target_system": "pc_user",
  "collection_started": "2025-08-08T17:10:11.375513",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:10:11.375528",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "system.log",
      "size_bytes": 20390070,
      "hash_sha256": "96aaed6f92f4635b06b6ed03093897945f3ca365313b50828f7166f103cdecf9",
      "created_time": "2025-07-12T17:10:11.375549",
      "modified_time": "2025-08-08T06:10:11.375559"
    },
    {
      "filename": "security.log",
      "size_bytes": 95665792,
      "hash_sha256": "1ba743af1f418983e3c71d2daf4f4e6e6e05c6beb0b06ec43baaa68e20ad171b",
      "created_time": "2025-07-09T17:10:11.375579",
      "modified_time": "2025-08-08T14:10:11.375584"
    },
    {
      "filename": "application.log",
      "size_bytes": 33882001,
      "hash_sha256": "d3cb53ac9b0c6a53ab7c105c465dbfd069e7e9bb3a0683718d8a782d198ae03e",
      "created_time": "2025-08-05T17:10:11.375599",
      "modified_time": "2025-08-08T16:10:11.375604"
    },
    {
      "filename": "firewall.log",
      "size_bytes": 2220083,
      "hash_sha256": "0314e3d4fe68e38bd26655f2f0959afa7886e8a582648b2c140f54392abb192e",
      "created_time": "2025-08-03T17:10:11.375617",
      "modified_time": "2025-08-08T09:10:11.375621"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:10:11.375627",
  "total_files": 4,
  "total_size_mb": 145.1091251373291
}[0m[31;1m[1;3m{
  "collection_id": "EVIDENCE_194453",
  "evidence_type": "network",
  "evidence_name": "ÍøÂçÁ÷Á¿",
  "target_system": "internal_db",
  "collection_started": "2025-08-08T17:10:11.377190",
  "collection_method": "Ô¶³ÌÈ¡Ö¤¹¤¾ß",
  "chain_of_custody": {
    "collector": "Êı×ÖÈ¡Ö¤×¨¼Ò",
    "collection_time": "2025-08-08T17:10:11.377199",
    "hash_algorithm": "SHA-256",
    "integrity_verified": true
  },
  "collected_files": [
    {
      "filename": "network_capture.pcap",
      "size_bytes": 13285647,
      "hash_sha256": "c915ce0e4bfcda6222f92726c8a6bf0ada712024a98aed294b62f69616e497c8",
      "created_time": "2025-08-03T17:10:11.377223",
      "modified_time": "2025-08-07T18:10:11.377232"
    },
    {
      "filename": "dns_queries.txt",
      "size_bytes": 65225815,
      "hash_sha256": "ea7f78c3ef0c0555ac3736493a5c88639fc872e38ea22bf66757e2f7096766bf",
      "created_time": "2025-07-09T17:10:11.377251",
      "modified_time": "2025-08-07T20:10:11.377257"
    },
    {
      "filename": "http_requests.txt",
      "size_bytes": 438337,
      "hash_sha256": "1d55be662bbf553c35a67f293cd2383fe8779431bace7a57a96ac64e8c200c75",
      "created_time": "2025-07-10T17:10:11.377272",
      "modified_time": "2025-08-08T07:10:11.377277"
    }
  ],
  "status": "success",
  "collection_completed": "2025-08-08T17:10:11.377283",
  "total_files": 3,
  "total_size_mb": 75.29239559173584
}[0m[32;1m[1;3m
Invoking: `generate_incident_report` with `{'incident_id': 'INC_183368'}`


[0m[33;1m[1;3m{
  "report_id": "INCIDENT_884466",
  "incident_id": "INC_183368",
  "incident_type": "apt_attack",
  "incident_name": "¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
  "report_generated": "2025-08-08T17:10:19.968951",
  "executive_summary": {
    "incident_overview": "¼ì²âµ½Õë¶Ô×éÖ¯µÄ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷",
    "impact_assessment": "ÖĞµÈµ½¸ßµÈÓ°Ïì",
    "current_status": "ÒÑ¿ØÖÆ",
    "estimated_cost": "$287,345"
  },
  "timeline": {
    "first_detection": "2025-08-07T17:10:19.968965",
    "incident_declared": "2025-08-07T18:10:19.968974",
    "containment_achieved": "2025-08-07T23:10:19.968977",
    "eradication_completed": "2025-08-08T05:10:19.968979",
    "recovery_started": "2025-08-08T11:10:19.968982"
  },
  "affected_systems": [
    {
      "system": "dmz_web",
      "impact": "¸ß",
      "status": "ÒÑ»Ö¸´"
    },
    {
      "system": "internal_db",
      "impact": "ÖĞ",
      "status": "¼à¿ØÖĞ"
    },
    {
      "system": "pc_user",
      "impact": "¸ß",
      "status": "ÒÑÖØ½¨"
    }
  ],
  "attack_vectors": [
    "µöÓãÓÊ¼ş",
    "WebÓ¦ÓÃÂ©¶´",
    "ºáÏòÒÆ¶¯",
    "È¨ÏŞÌáÉı"
  ],
  "evidence_collected": [
    "ÏµÍ³ÈÕÖ¾ (50GB)",
    "ÍøÂçÁ÷Á¿²¶»ñ (200GB)",
    "ÄÚ´æ¾µÏñ (32GB)",
    "¶ñÒâÈí¼şÑù±¾ (15¸ö)"
  ],
  "lessons_learned": [
    "ĞèÒª¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ",
    "Ó¦ÊµÊ©¸üÑÏ¸ñµÄÍøÂç·Ö¶Î",
    "ĞèÒª²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³",
    "Ó¦½¨Á¢¸üÍêÉÆµÄÊÂ¼şÏìÓ¦Á÷³Ì"
  ],
  "recommendations": [
    "ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹",
    "²¿ÊğEDR½â¾ö·½°¸",
    "¼ÓÇ¿ÍşĞ²Çé±¨ÄÜÁ¦",
    "¶¨ÆÚ½øĞĞ°²È«ÑİÁ·",
    "½¨Á¢ÍşĞ²ÁÔÉ±ÍÅ¶Ó"
  ]
}[0m[32;1m[1;3m### ÊÂ¼ş·ÖÎö±¨¸æÕªÒª

**ÊÂ¼şID**: INC_183368  
**ÊÂ¼şÀàĞÍ**: ¸ß¼¶³ÖĞøĞÔÍşĞ²¹¥»÷ (APT)  
**¹¥»÷Ê±¼äÏß**: 2025Äê8ÔÂ7ÈÕÖÁ8ÔÂ8ÈÕ  
**¹¥»÷³ÖĞøÊ±¼ä**: 8Ğ¡Ê±45·ÖÖÓ  
**¹¥»÷Ó°Ïì**: ÖĞµÈµ½¸ßµÈ  

---

#### **¹¥»÷Â·¾¶Óë½×¶Î**
1. **Õì²ì½×¶Î**:
   - ¶Ë¿ÚÉ¨Ãè»î¶¯ (Ô´IP: 203.0.113.100)
   - WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ (Ä¿±ê: DMZ Web·şÎñÆ÷)
2. **ÎäÆ÷»¯ÓëÍ¶µİ**:
   - µöÓãÓÊ¼şÖÆ×÷ÓëÍ¶µİ (Ô´IP: 198.51.100.50)
3. **ÀûÓÃÓë³Ö¾Ã»¯**:
   - ¶ñÒâÁ´½Óµã»÷µ¼ÖÂºóÃÅ³ÌĞò°²×°
   - ³É¹¦½¨Á¢C2Í¨ĞÅ (Ä¿±êIP: 203.0.113.200)
4. **ºáÏòÒÆ¶¯ÓëÊı¾İÇÔÈ¡**:
   - ºáÏòÒÆ¶¯µ½ÄÚ²¿Êı¾İ¿â (Ä¿±ê: internal_db)
   - Ãô¸ĞÊı¾İ·ÃÎÊĞĞÎª

---

#### **ÍşĞ²ĞĞÎªÕß»­Ïñ**
- **Éí·İ**: Î´ÖªÍşĞ²ĞĞÎªÕß  
- **¶¯»ú**: Î´È·¶¨  
- **¹¥»÷¼¼Êõ**:
  - ¶à½×¶Î¹¥»÷²ßÂÔ
  - µöÓãÓÊ¼ş³õÊ¼·ÃÎÊ
  - ³Ö¾Ã»¯·ÃÎÊÓëºáÏòÒÆ¶¯
- **¹¥»÷¸´ÔÓ¶È**: ÖĞµÈ  
- **½¨Òé**: ¼ÓÇ¿ÍşĞ²Çé±¨ÊÕ¼¯ÓëĞĞÎª·ÖÎö¼à¿Ø¡£

---

#### **ÊÕ¼¯µÄÊı×ÖÖ¤¾İ**
1. **ÏµÍ³ÈÕÖ¾** (Ä¿±ê: pc_user)
   - ÎÄ¼ş: `system.log`, `security.log`, `application.log`, `firewall.log`
   - ÍêÕûĞÔÒÑÑéÖ¤ (SHA-256¹şÏ£)
2. **ÍøÂçÁ÷Á¿** (Ä¿±ê: internal_db)
   - ÎÄ¼ş: `network_capture.pcap`, `dns_queries.txt`, `http_requests.txt`
   - ÍêÕûĞÔÒÑÑéÖ¤ (SHA-256¹şÏ£)

---

#### **·À»¤½¨Òé**
1. **¼¼Êõ´ëÊ©**:
   - ²¿Êğ¸ß¼¶ÍşĞ²¼ì²âÏµÍ³ (ÈçEDR)¡£
   - ÊµÊ©ÁãĞÅÈÎÍøÂç¼Ü¹¹¡£
2. **Á÷³Ì¸Ä½ø**:
   - ¶¨ÆÚ½øĞĞ°²È«ÑİÁ·¡£
   - ½¨Á¢ÍşĞ²ÁÔÉ±ÍÅ¶Ó¡£
3. **ÈËÔ±ÅàÑµ**:
   - ¼ÓÇ¿Ô±¹¤°²È«ÒâÊ¶ÅàÑµ£¬ÌØ±ğÊÇµöÓãÓÊ¼şÊ¶±ğ¡£

---

#### **ÍêÕû±¨¸æ**
ÈçĞèÏêÏ¸±¨¸æ£¬Çë²Î¿¼Éú³ÉµÄ±¨¸æID: `INCIDENT_884466`¡£[0m2025-08-08 17:10:51,015 - attribution-agent - WARNING - ·¢ËÍÏûÏ¢Ê§°Ü£¬³¢ÊÔÖØĞÂÁ¬½Ó: sent 1011 (internal error) keepalive ping timeout; no close frame received
C:\Users\LEGION\Desktop\sec_agent\agents\defense_agent\attribution_agent.py:49: DeprecationWarning: websockets.client.connect is deprecated
  websockets.client.connect(
2025-08-08 17:10:53,051 - attribution-agent - INFO - ÒÑÁ¬½Óµ½ºó¶ËWebSocket: ws://localhost:8080/ws/logs
2025-08-08 17:10:56,768 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:11:04,329 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:04,329 - mcp.client.streamable_http - INFO - Received session ID: 20bf66f755d4430cbb7efd9e0f87b457
2025-08-08 17:11:04,330 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:11:04,335 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:11:04,336 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:04,340 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:04,341 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:06,365 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:07,364 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:07,478 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:11:28,323 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:11:36,568 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:36,569 - mcp.client.streamable_http - INFO - Received session ID: 9393f9d1c7714d2ea698348174ef1c44
2025-08-08 17:11:36,569 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:11:36,575 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:11:36,576 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:36,581 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:36,582 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:38,593 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:39,604 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"


[1m> Finished chain.[0m


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m
Invoking: `analyze_attack_timeline` with `{'start_time': '2025-01-01T00:00:00', 'end_time': '2025-12-31T23:59:59'}`


[0m[32;1m[1;3m
Invoking: `trace_attack_path` with `{'source_node': 'internet', 'target_node': '¿ª·Å¶Ë¿Ú'}`


[0m[33;1m[1;3m{"error": "ÎŞ·¨ÕÒµ½´Ó internet µ½ ¿ª·Å¶Ë¿Ú µÄÂ·¾¶"}[0m[36;1m[1;3m{
  "analysis_id": "TIMELINE_467511",
  "analysis_period": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-12-31T23:59:59"
  },
  "total_events": 9,
  "attack_duration": "8Ğ¡Ê±45·ÖÖÓ",
  "attack_stages": {
    "reconnaissance": 2,
    "weaponization": 1,
    "delivery": 1,
    "exploitation": 1,
    "installation": 1,
    "command_and_control": 1,
    "actions_on_objectives": 2
  },
  "events": [
    {
      "timestamp": "2025-08-07T17:26:07.356179",
      "stage": "reconnaissance",
      "event": "¶Ë¿ÚÉ¨Ãè»î¶¯",
      "source_ip": "203.0.113.100",
      "target": "firewall",
      "technique": "T1046 - Network Service Scanning",
      "confidence": 95
    },
    {
      "timestamp": "2025-08-07T17:41:07.356207",
      "stage": "reconnaissance",
      "event": "WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ",
      "source_ip": "203.0.113.100",
      "target": "dmz_web",
      "technique": "T1590 - Gather Victim Network Information",
      "confidence": 90
    },
    {
      "timestamp": "2025-08-07T18:56:07.356213",
      "stage": "weaponization",
      "event": "µöÓãÓÊ¼şÖÆ×÷",
      "source_ip": "unknown",
      "target": "pc_user",
      "technique": "T1566.001 - Spearphishing Attachment",
      "confidence": 85
    },
    {
      "timestamp": "2025-08-07T19:41:07.356220",
      "stage": "delivery",
      "event": "µöÓãÓÊ¼şÍ¶µİ",
      "source_ip": "198.51.100.50",
      "target": "pc_user",
      "technique": "T1566.002 - Spearphishing Link",
      "confidence": 92
    },
    {
      "timestamp": "2025-08-07T20:26:07.356224",
      "stage": "exploitation",
      "event": "¶ñÒâÁ´½Óµã»÷",
      "source_ip": "pc_user",
      "target": "198.51.100.50",
      "technique": "T1204.002 - Malicious File",
      "confidence": 88
    },
    {
      "timestamp": "2025-08-07T21:51:07.356228",
      "stage": "installation",
      "event": "ºóÃÅ³ÌĞò°²×°",
      "source_ip": "pc_user",
      "target": "pc_user",
      "technique": "T1547.001 - Registry Run Keys",
      "confidence": 94
    },
    {
      "timestamp": "2025-08-07T23:01:07.356231",
      "stage": "command_and_control",
      "event": "C2Í¨ĞÅ½¨Á¢",
      "source_ip": "pc_user",
      "target": "203.0.113.200",
      "technique": "T1071.001 - Web Protocols",
      "confidence": 96
    },
    {
      "timestamp": "2025-08-08T00:41:07.356235",
      "stage": "actions_on_objectives",
      "event": "ºáÏòÒÆ¶¯³¢ÊÔ",
      "source_ip": "pc_user",
      "target": "internal_db",
      "technique": "T1021.001 - Remote Desktop Protocol",
      "confidence": 89
    },
    {
      "timestamp": "2025-08-08T01:26:07.356240",
      "stage": "actions_on_objectives",
      "event": "Ãô¸ĞÊı¾İ·ÃÎÊ",
      "source_ip": "internal_db",
      "target": "internal_db",
      "technique": "T1005 - Data from Local System",
      "confidence": 91
    }
  ],
  "attack_path": [
    "internet ¡ú firewall (¶Ë¿ÚÉ¨Ãè)",
    "internet ¡ú dmz_web (WebÖ¸ÎÆÊ¶±ğ)",
    "internet ¡ú pc_user (µöÓãÓÊ¼ş)",
    "pc_user ¡ú C2·şÎñÆ÷ (½¨Á¢Í¨ĞÅ)",
    "pc_user ¡ú internal_db (ºáÏòÒÆ¶¯)",
    "internal_db ¡ú Êı¾İÇÔÈ¡"
  ],
  "key_indicators": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ]
}[0m

[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3m### ¹¥»÷Ê±¼äÏß·ÖÎö
¹¥»÷Ê±¼äÏß·ÖÎöÒÑÍê³É£¬ÒÔÏÂÊÇ¹Ø¼ü·¢ÏÖ£º
- **¹¥»÷³ÖĞøÊ±¼ä**£º8Ğ¡Ê±45·ÖÖÓ
- **¹¥»÷½×¶Î**£º
  1. **Õì²ì½×¶Î**£º¹¥»÷Õß½øĞĞÁË¶Ë¿ÚÉ¨ÃèºÍWebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ¡£
  2. **ÎäÆ÷»¯½×¶Î**£ºÖÆ×÷ÁËµöÓãÓÊ¼ş¡£
  3. **Í¶µİ½×¶Î**£ºÍ¨¹ıµöÓãÓÊ¼şÍ¶µİ¶ñÒâÁ´½Ó¡£
  4. **ÀûÓÃ½×¶Î**£ºÓÃ»§µã»÷¶ñÒâÁ´½Ó¡£
  5. **°²×°½×¶Î**£ººóÃÅ³ÌĞò°²×°³É¹¦¡£
  6. **ÃüÁîÓë¿ØÖÆ**£º½¨Á¢ÁËC2Í¨ĞÅ¡£
  7. **Ä¿±êĞĞ¶¯**£º³¢ÊÔºáÏòÒÆ¶¯²¢·ÃÎÊÃô¸ĞÊı¾İ¡£

- **¹Ø¼üÖ¸±ê**£º
  - ¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ¡£
  - ³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ¡£
  - ³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ¡£
  - ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú¡£
  - ´æÔÚÊı¾İÇÔÈ¡ĞĞÎª¡£

### ¹¥»÷Â·¾¶×·×Ù
Î´ÄÜÕÒµ½´Ó¡°internet¡±µ½¡°¿ª·Å¶Ë¿Ú¡±µÄÖ±½Ó¹¥»÷Â·¾¶¡£¿ÉÄÜµÄÔ­Òò°üÀ¨£º
- ¹¥»÷Â·¾¶¿ÉÄÜÉæ¼°¶à¸öÌø°å»òÖĞ¼ä½Úµã¡£
- ¿ª·Å¶Ë¿Ú¿ÉÄÜÎ´±»Ö±½ÓÀûÓÃ£¬¶øÊÇÍ¨¹ıÆäËû·½Ê½£¨ÈçµöÓãÓÊ¼ş£©¼ä½ÓÀûÓÃ¡£

### ÏÂÒ»²½ĞĞ¶¯
1. **Éú³ÉÍşĞ²ĞĞÎªÕß»­Ïñ**£º»ùÓÚ¹¥»÷Ö¸±ê£¨ÈçµöÓãÓÊ¼ş¡¢C2Í¨ĞÅIPµÈ£©Éú³É¹¥»÷Õß»­Ïñ¡£
2. **ÊÕ¼¯Êı×ÖÖ¤¾İ**£º´ÓÈÕÖ¾ºÍÍøÂçÖĞÊÕ¼¯Ïà¹ØÖ¤¾İ¡£
3. **¶ñÒâÈí¼ş·ÖÎö**£ºÈç¹û·¢ÏÖ¶ñÒâÈí¼şÑù±¾£¬½«½øĞĞÉî¶È·ÖÎö¡£
4. **Éú³ÉÊÂ¼ş±¨¸æ**£ºÕûºÏËùÓĞ·ÖÎö½á¹ûÉú³É×ÛºÏ±¨¸æ¡£

ÇëÈ·ÈÏÊÇ·ñ¼ÌĞøÖ´ĞĞºóĞøÈÎÎñ¡£[0m

[1m> Finished chain.[0m
[32;1m[1;3m
Invoking: `analyze_attack_timeline` with `{'start_time': '2025-01-01T00:00:00', 'end_time': '2025-12-31T23:59:59'}`


[0m[32;1m[1;3m
Invoking: `trace_attack_path` with `{'source_node': 'internet', 'target_node': '-'}`


[0m[33;1m[1;3m{"error": "ÎŞ·¨ÕÒµ½´Ó internet µ½ - µÄÂ·¾¶"}[0m[36;1m[1;3m{
  "analysis_id": "TIMELINE_516513",
  "analysis_period": {
    "start": "2025-01-01T00:00:00",
    "end": "2025-12-31T23:59:59"
  },
  "total_events": 9,
  "attack_duration": "8Ğ¡Ê±45·ÖÖÓ",
  "attack_stages": {
    "reconnaissance": 2,
    "weaponization": 1,
    "delivery": 1,
    "exploitation": 1,
    "installation": 1,
    "command_and_control": 1,
    "actions_on_objectives": 2
  },
  "events": [
    {
      "timestamp": "2025-08-07T17:26:39.595969",
      "stage": "reconnaissance",
      "event": "¶Ë¿ÚÉ¨Ãè»î¶¯",
      "source_ip": "203.0.113.100",
      "target": "firewall",
      "technique": "T1046 - Network Service Scanning",
      "confidence": 95
    },
    {
      "timestamp": "2025-08-07T17:41:39.596000",
      "stage": "reconnaissance",
      "event": "WebÓ¦ÓÃÖ¸ÎÆÊ¶±ğ",
      "source_ip": "203.0.113.100",
      "target": "dmz_web",
      "technique": "T1590 - Gather Victim Network Information",
      "confidence": 90
    },
    {
      "timestamp": "2025-08-07T18:56:39.596007",
      "stage": "weaponization",
      "event": "µöÓãÓÊ¼şÖÆ×÷",
      "source_ip": "unknown",
      "target": "pc_user",
      "technique": "T1566.001 - Spearphishing Attachment",
      "confidence": 85
    },
    {
      "timestamp": "2025-08-07T19:41:39.596013",
      "stage": "delivery",
      "event": "µöÓãÓÊ¼şÍ¶µİ",
      "source_ip": "198.51.100.50",
      "target": "pc_user",
      "technique": "T1566.002 - Spearphishing Link",
      "confidence": 92
    },
    {
      "timestamp": "2025-08-07T20:26:39.596018",
      "stage": "exploitation",
      "event": "¶ñÒâÁ´½Óµã»÷",
      "source_ip": "pc_user",
      "target": "198.51.100.50",
      "technique": "T1204.002 - Malicious File",
      "confidence": 88
    },
    {
      "timestamp": "2025-08-07T21:51:39.596023",
      "stage": "installation",
      "event": "ºóÃÅ³ÌĞò°²×°",
      "source_ip": "pc_user",
      "target": "pc_user",
      "technique": "T1547.001 - Registry Run Keys",
      "confidence": 94
    },
    {
      "timestamp": "2025-08-07T23:01:39.596028",
      "stage": "command_and_control",
      "event": "C2Í¨ĞÅ½¨Á¢",
      "source_ip": "pc_user",
      "target": "203.0.113.200",
      "technique": "T1071.001 - Web Protocols",
      "confidence": 96
    },
    {
      "timestamp": "2025-08-08T00:41:39.596034",
      "stage": "actions_on_objectives",
      "event": "ºáÏòÒÆ¶¯³¢ÊÔ",
      "source_ip": "pc_user",
      "target": "internal_db",
      "technique": "T1021.001 - Remote Desktop Protocol",
      "confidence": 89
    },
    {
      "timestamp": "2025-08-08T01:26:39.596039",
      "stage": "actions_on_objectives",
      "event": "Ãô¸ĞÊı¾İ·ÃÎÊ",
      "source_ip": "internal_db",
      "target": "internal_db",
      "technique": "T1005 - Data from Local System",
      "confidence": 91
    }
  ],
  "attack_path": [
    "internet ¡ú firewall (¶Ë¿ÚÉ¨Ãè)",
    "internet ¡ú dmz_web (WebÖ¸ÎÆÊ¶±ğ)",
    "internet ¡ú pc_user (µöÓãÓÊ¼ş)",
    "pc_user ¡ú C2·şÎñÆ÷ (½¨Á¢Í¨ĞÅ)",
    "pc_user ¡ú internal_db (ºáÏòÒÆ¶¯)",
    "internal_db ¡ú Êı¾İÇÔÈ¡"
  ],
  "key_indicators": [
    "¹¥»÷ÕßÊ¹ÓÃ¶à½×¶Î¹¥»÷²ßÂÔ",
    "³õÊ¼·ÃÎÊÍ¨¹ıµöÓãÓÊ¼şÊµÏÖ",
    "³É¹¦½¨Á¢³Ö¾Ã»¯·ÃÎÊ",
    "ÊµÏÖÁËºáÏòÒÆ¶¯µ½¹Ø¼ü×Ê²ú",
    "´æÔÚÊı¾İÇÔÈ¡ĞĞÎª"
  ]
}[0m2025-08-08 17:11:39,714 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:11:48,795 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:48,795 - mcp.client.streamable_http - INFO - Received session ID: 258e14826bcc44d8bf31ab81f2c4ff66
2025-08-08 17:11:48,796 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:11:48,803 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:11:48,805 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:48,810 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:48,812 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:52,833 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:53,827 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:11:54,037 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:12:02,288 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:02,288 - mcp.client.streamable_http - INFO - Received session ID: c211a63b24b34040b6d18b141afcd4da
2025-08-08 17:12:02,289 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:12:02,295 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:12:02,297 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:02,302 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:02,304 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:07,328 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:07,331 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:07,344 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:07,674 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-08-08 17:12:13,388 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:13,388 - mcp.client.streamable_http - INFO - Received session ID: e619075e37504c2fa3c247e95ffec796
2025-08-08 17:12:13,388 - mcp.client.streamable_http - INFO - Negotiated protocol version: 2025-06-18
2025-08-08 17:12:13,394 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 202 Accepted"
2025-08-08 17:12:13,397 - httpx - INFO - HTTP Request: GET http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:13,399 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:16,419 - httpx - INFO - HTTP Request: POST http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:16,424 - httpx - INFO - HTTP Request: DELETE http://127.0.0.1:8010/mcp/ "HTTP/1.1 200 OK"
2025-08-08 17:12:16,565 - httpx - INFO - HTTP Request: POST https://api.deepseek.com/v1/chat/completions "HTTP/1.1 200 OK"
