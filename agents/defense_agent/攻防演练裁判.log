2025-08-07 15:07:00,964 - battle-judge - INFO - 攻防演练裁判系统已启动
C:\Users\LEGION\Desktop\sec_agent\agents\defense_agent\battle_judge.py:81: DeprecationWarning: websockets.client.connect is deprecated
  self.ws_connection = await websockets.client.connect(BACKEND_WS_URL)
2025-08-07 15:07:03,034 - battle-judge - INFO - 攻防演练裁判系统已连接到WebSocket
2025-08-07 20:59:18,571 - battle-judge - WARNING - WebSocket连接断开，尝试重连...
2025-08-07 20:59:25,625 - battle-judge - INFO - 攻防演练裁判系统已连接到WebSocket
2025-08-07 20:59:25,654 - battle-judge - WARNING - WebSocket连接断开，尝试重连...
2025-08-07 20:59:32,685 - battle-judge - INFO - 攻防演练裁判系统已连接到WebSocket
2025-08-07 21:02:31,389 - battle-judge - WARNING - WebSocket连接断开，尝试重连...
2025-08-07 21:02:38,427 - battle-judge - INFO - 攻防演练裁判系统已连接到WebSocket
2025-08-07 21:17:48,617 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:17:48,675 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:17:54,516 - battle-judge - INFO - 攻击进度更新: 侦察阶段完成
2025-08-07 21:17:54,899 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:17:55,444 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:18:01,915 - battle-judge - INFO - 攻击进度更新: 武器化阶段完成
2025-08-07 21:18:06,546 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:06,546 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:06,547 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:06,547 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:12,050 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:12,050 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:12,059 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:12,059 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:17,284 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:17,284 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:19,170 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:19,171 - battle-judge - INFO - IP已阻断: 192.168.0.0
2025-08-07 21:18:20,904 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:18:20,904 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:18:25,645 - battle-judge - INFO - 攻击进度更新: 投递阶段完成
2025-08-07 21:18:27,568 - battle-judge - INFO - 防御进度更新: 威胁检测完成
2025-08-07 21:18:27,649 - battle-judge - INFO - 攻击进度更新: 利用阶段完成
2025-08-07 21:18:27,649 - battle-judge - INFO - 资产被攻陷: ws-user-01
2025-08-07 21:18:28,658 - battle-judge - INFO - 攻击进度更新: 利用阶段完成
2025-08-07 21:18:28,658 - battle-judge - INFO - 资产被攻陷: ws-user-01
2025-08-07 21:18:29,673 - battle-judge - INFO - 攻击进度更新: 安装阶段完成
2025-08-07 21:18:30,688 - battle-judge - INFO - 攻击进度更新: 安装阶段完成
2025-08-07 21:18:31,691 - battle-judge - INFO - 攻击进度更新: C2阶段完成
2025-08-07 21:18:33,719 - battle-judge - INFO - 攻击进度更新: 数据窃取完成 - 这可能触发攻击方胜利
2025-08-07 21:18:44,262 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:44,263 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:44,263 - battle-judge - INFO - IP已阻断: 192.168.57.163
2025-08-07 21:18:44,265 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:44,265 - battle-judge - INFO - IP已阻断: 192.168.88.109
2025-08-07 21:18:44,778 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:45,795 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:18:49,092 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:18:56,243 - battle-judge - INFO - 防御进度更新: 威胁检测完成
2025-08-07 21:19:21,055 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:30,294 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:19:35,333 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:35,333 - battle-judge - INFO - IP已阻断: 192.168.100.200
2025-08-07 21:19:35,334 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:35,335 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:35,335 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:36,909 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:36,915 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:36,925 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:19:48,729 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:19:55,557 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:19:57,838 - battle-judge - INFO - 防御进度更新: 证据收集完成
2025-08-07 21:19:57,838 - battle-judge - INFO - 攻击溯源报告已生成，准备进行最终胜负判定
2025-08-07 21:20:03,244 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:20:03,244 - battle-judge - INFO - IP已阻断: 192.168.100.200
2025-08-07 21:20:28,873 - battle-judge - INFO - 防御进度更新: 漏洞修复完成
2025-08-07 21:20:28,873 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:28,874 - battle-judge - INFO - 攻击方胜利条件满足
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:28,874 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,216 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:34,217 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,818 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:37,818 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,819 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,819 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,819 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,819 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:37,819 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,609 - battle-judge - INFO - 防御进度更新: 漏洞修复完成
2025-08-07 21:20:44,609 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:44,609 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,609 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,609 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,610 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,610 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:44,610 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,069 - battle-judge - INFO - 防御进度更新: 漏洞修复完成
2025-08-07 21:20:45,069 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:45,069 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,070 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,070 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,070 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,070 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:45,070 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,563 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:49,564 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,250 - battle-judge - INFO - 防御进度更新: 漏洞修复完成
2025-08-07 21:20:59,250 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:20:59,250 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,251 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,251 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,251 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,251 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:20:59,251 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,982 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:03,982 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,982 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,982 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,983 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,983 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:03,983 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,245 - battle-judge - INFO - 防御进度更新: 威胁检测完成
2025-08-07 21:21:23,246 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:23,246 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,913 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:21:34,914 - battle-judge - INFO - IP已阻断: 192.168.214.115
2025-08-07 21:21:34,914 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:34,914 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,914 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,914 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,914 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,914 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:34,915 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,520 - battle-judge - INFO - 防御进度更新: IP阻断完成
2025-08-07 21:21:36,520 - battle-judge - INFO - IP已阻断: 192.168.214.115
2025-08-07 21:21:36,520 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:36,520 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,520 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,520 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,520 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,521 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:36,521 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,457 - battle-judge - INFO - 防御进度更新: 攻击溯源完成
2025-08-07 21:21:45,457 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:45,457 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,457 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,457 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,458 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,458 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:45,458 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,389 - battle-judge - INFO - \U0001f6e1\ufe0f 所有防御工作已完成，通知裁判进行最终胜负判定
2025-08-07 21:21:52,389 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,390 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,390 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,390 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,390 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
2025-08-07 21:21:52,390 - battle-judge - ERROR - 发送裁判日志失败: Object of type set is not JSON serializable
