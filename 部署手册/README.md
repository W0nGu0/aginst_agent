# AI Agent 驱动的动态攻防推演靶场平台 - 部署手册

## 📋 项目概述

本项目是一个基于AI Agent的动态攻防推演靶场平台，实现了动态场景生成、智能攻击模拟、自适应防御决策和演练评估自动化等核心功能。

### 🏗️ 系统架构
- **前端**: Vue.js 3 + Vite + TailwindCSS + DaisyUI
- **后端**: Python FastAPI
- **智能代理**: 6个专业AI Agent (攻击、防御、场景、评估、中央控制、受害主机)
- **服务层**: 7个微服务 (攻击、防御、场景、评估、归因、威胁阻断、漏洞)
- **容器化**: Docker + Docker Compose + Kubernetes
- **AI模型**: 基于DeepSeek API

## 🔧 环境要求

### 硬件要求
- **CPU**: 4核心以上 (推荐8核心)
- **内存**: 8GB以上 (推荐16GB)
- **存储**: 50GB以上可用空间
- **网络**: 稳定的互联网连接 (用于AI API调用)

### 软件要求
- **操作系统**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **Docker**: 20.10+ 
- **Docker Compose**: 2.0+
- **Node.js**: 18.0+ (推荐LTS版本)
- **Python**: 3.9+
- **Git**: 2.30+

## 🚀 部署方案选择

### 方案一：快速本地部署 (推荐新手)
适用于开发、测试和演示环境
- **部署时间**: 5-10分钟
- **资源需求**: 最低
- **维护难度**: 简单

**部署步骤**:
1. 阅读 [快速开始指南](quick-start.md)
2. 运行对应平台的一键部署脚本

### 方案二：Docker Compose部署 (推荐小团队)
适用于小规模生产环境和团队开发
- **部署时间**: 15-30分钟
- **资源需求**: 中等
- **维护难度**: 中等

**部署步骤**:
1. 阅读 [Docker Compose部署指南](docker-compose-部署.md)
2. 配置环境变量和Docker Compose文件
3. 执行容器化部署

### 方案三：Kubernetes部署 (推荐企业)
适用于大规模生产环境和企业级部署
- **部署时间**: 30-60分钟
- **资源需求**: 最高
- **维护难度**: 复杂

**部署步骤**:
1. 阅读 [Kubernetes容器化部署指南](容器化部署指南.md)
2. 准备Kubernetes集群
3. 执行 `k8s-deploy.sh` 脚本

## 📁 部署文件说明

| 文件名 | 说明 | 适用场景 |
|--------|------|----------|
| **一键部署脚本** | | |
| `deploy.py` | Python跨平台部署脚本 | 所有平台快速部署 |
| `deploy.bat` | Windows批处理部署脚本 | Windows快速部署 |
| `deploy.sh` | Linux/macOS Shell脚本 | Linux/macOS快速部署 |
| `k8s-deploy.sh` | Kubernetes一键部署脚本 | K8s集群部署 |
| **详细指南** | | |
| `总体部署文档.md` | 完整系统部署概览 | 了解整体架构 |
| `详细手动部署指南.md` | 手动部署详细步骤 | 自定义部署需求 |
| `容器化部署指南.md` | Kubernetes容器化部署 | 企业级生产环境 |
| `docker-compose-部署.md` | Docker Compose部署 | 中小规模部署 |
| `生产环境部署.md` | 生产环境配置指南 | 生产环境优化 |
| **配置和运维** | | |
| `配置文件说明.md` | 配置文件详细说明 | 自定义配置 |
| `故障排除指南.md` | 常见问题解决方案 | 问题诊断修复 |
| `部署验证脚本.py` | 自动化部署验证 | 验证部署结果 |

## 🌐 服务端口映射

### 核心服务
| 服务名称 | 端口 | 协议 | 说明 |
|----------|------|------|------|
| 前端开发服务器 | 5173 | HTTP | Vue.js开发服务器 |
| 后端API网关 | 8080 | HTTP/WS | FastAPI后端服务 |

### AI智能代理
| 智能代理 | 端口 | 协议 | 功能说明 |
|----------|------|------|----------|
| 场景智能体 | 8007 | HTTP | 动态场景生成和管理 |
| 攻击智能体 | 8004 | HTTP | 智能攻击模拟和执行 |
| 中央控制智能体 | 8006 | HTTP/WS | 攻防演练协调控制 |
| 评估智能体 | 8014 | HTTP | 演练效果评估分析 |
| 受害主机智能体 | 8015 | HTTP | 受害者行为模拟 |

### MCP微服务
| 微服务 | 端口 | 协议 | 功能说明 |
|--------|------|------|----------|
| 场景服务 | 8002 | HTTP | 场景模板和容器管理 |
| 攻击服务 | 8001 | HTTP | 攻击工具和技术库 |
| 评估服务 | 8005 | HTTP | 评估模型和报告生成 |

## 🔧 配置要求

### 必需配置
1. **DeepSeek API密钥**: 在 `agents/scenario_agent/.env` 中配置
2. **Docker环境**: 确保Docker服务正常运行
3. **网络端口**: 确保所需端口可用

### 可选配置
- 自定义端口映射
- 数据库连接配置
- 日志级别设置
- CORS跨域配置

## 🌐 访问地址

部署成功后，您可以通过以下地址访问系统：

- **前端界面**: http://localhost:5173
- **后端API文档**: http://localhost:8080/docs
- **场景服务**: http://localhost:8002
- **场景智能体**: http://localhost:8007

## 🔍 部署验证

### 自动化验证
```bash
# 运行部署验证脚本
python 部署验证脚本.py
```

### 手动验证
```bash
# 测试前端和后端连接
python ../test_phase2_frontend.py

# 测试场景智能体健康状态
python ../test_scenario_agent_health.py

# 测试后端到智能体的连接
python ../test_backend_to_agent.py
```

## 🚨 常见问题快速解决

### 端口冲突
```bash
# 查看端口占用
netstat -tulpn | grep :8080

# 终止占用进程
kill -9 <PID>
```

### API密钥问题
```bash
# 检查配置文件
cat ../agents/scenario_agent/.env

# 验证API连接
curl -H "Authorization: Bearer YOUR_API_KEY" \
     https://api.deepseek.com/v1/models
```

### Docker服务问题
```bash
# 检查Docker状态
docker info

# 重启Docker服务
sudo systemctl restart docker
```

## 📞 技术支持

### 获取帮助
- **部署问题**: 查看 [故障排除指南](故障排除指南.md)
- **配置问题**: 参考 [配置文件说明](配置文件说明.md)
- **生产部署**: 查看 [生产环境指南](生产环境部署.md)

### 联系方式
- **技术文档**: 项目README和docs目录
- **问题反馈**: 项目Issue追踪系统
- **技术讨论**: 开发团队技术论坛

## 📚 相关文档

- [系统架构说明](../docs/architecture.md)
- [API接口文档](api-documentation.md)
- [开发者指南](developer-guide.md)
- [用户使用手册](user-manual.md)

## 🎯 部署建议

### 开发环境
- 使用快速本地部署
- 启用调试模式
- 使用开发数据库

### 测试环境
- 使用Docker Compose部署
- 配置CI/CD集成
- 启用自动化测试

### 生产环境
- 使用Kubernetes部署
- 配置高可用和负载均衡
- 启用监控和告警
- 定期备份数据

---

**版本**: v2.0.0  
**更新日期**: 2024年12月  
**维护团队**: AI Agent攻防推演平台开发团队

**注意**: 请根据您的具体需求选择合适的部署方案。建议先在开发环境中验证部署流程，再部署到生产环境。
